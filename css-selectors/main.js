(()=>{"use strict";function e(e,t){void 0===t&&(t=document);var l=t.querySelector(e);if(!l)throw new Error("Sorry, element ".concat(e," not found"));return l}var t=function(){function t(){}return t.prototype.openCloseLevelMenu=function(){var t=e(".hamb");t.addEventListener("click",(function(){var e;t.classList.toggle("active"),null===(e=document.querySelector(".sidebar"))||void 0===e||e.classList.toggle("open")}))},t}(),l=[{levelNumber:1,levelTitle:"Сhoose right cube",items:["cube","cube"],classes:[null,"move"],answer:[".right-cube"],markup:['<cube class="left-cube" />','<cube class="right-cube" />'],hints:['<cube class="left-cube"></cube>','<cube class="right-cube"></cube>']},{levelNumber:2,levelTitle:"Сhoose red big balls",items:["ball","little-ball","ball"],classes:["move",null,"move"],answer:["ball"],markup:["<ball />","<little-ball />","<ball />"],hints:["<ball></ball>","<little-ball></little-ball>","<ball></ball>"]},{levelNumber:3,levelTitle:"Сhoose little cube",items:["little-cube","cube","ball"],classes:["move",null,null],answer:["#little-cube"],markup:['<cube id="little-cube" />',"<cube />","<ball />"],hints:['<cube id="little-cube></cube>',"<cube></cube>","<ball></ball>"]},{levelNumber:4,levelTitle:"Сhoose white cubes",items:["ball","cube","cube"],classes:[null,"move","move"],answer:["cube"],markup:["<ball />","<cube />","<cube />"],hints:["<ball></ball>","<cube></cube>","<cube></cube>"]},{levelNumber:5,levelTitle:"Сhoose white cubes and ball",items:["ball","cube","cube","ball","ball"],classes:[null,"move","move","move",null],answer:["cube, .select-ball",".select-ball, cube"],markup:["<ball />","<cube />","<cube />",'<ball class="select-ball" />',"<ball />"],hints:["<ball></ball>","<cube></cube>","<cube></cube>",'<ball class="select-ball"></ball>',"<ball></ball>"]},{levelNumber:6,levelTitle:"Сhoose pyramid",items:["cube","pyramid","little-cube","pyramid","ball"],classes:[null,"move",null,"move",null],answer:["pyramid"],markup:["<cube />","<pyramid />","<little-cube />","<pyramid />","<ball />"],hints:["<cube></cube>","<pyramid></pyramid>","<little-cube></little-cube>","<pyramid></pyramid>","<ball></ball>"]},{levelNumber:7,levelTitle:"Сhoose balls",items:["pyramid","little-ball","pyramid","little-cube","ball"],classes:[null,"move",null,null,"move"],answer:[".ball"],markup:["<pyramid />",'<little-ball class="ball" />',"<pyramid />","<little-cube />",'<ball class="ball" />'],hints:["<pyramid></pyramid>",'<little-ball class="ball"></little-ball>',"<pyramid></pyramid>","<little-cube></little-cube>",'<ball class="ball"></ball>']},{levelNumber:8,levelTitle:"Сhoose pyramids and balls",items:["pyramid","little-cube","little-ball","pyramid","ball"],classes:["move",null,"move","move","move"],answer:["pyramid, .ball",".ball, pyramid"],markup:["<pyramid />","<little-cube />",'<little-ball class="ball" />',"<pyramid />",'<ball class="ball" />'],hints:["<pyramid></pyramid>","<little-cube></little-cube>",'<little-ball class="ball"></little-ball>',"<pyramid></pyramid>",'<ball class="ball"></ball>']},{levelNumber:9,levelTitle:"Сhoose pyramid and little cube",items:["little-ball","pyramid","ball","pyramid","little-cube"],classes:[null,null,null,"move","move"],answer:["pyramid:nth-child(2), little-cube","little-cube, pyramid:nth-child(2)"],markup:["<little-ball />","<pyramid />","<ball />","<pyramid />","<little-cube />"],hints:["<little-ball></little-ball>","<pyramid></pyramid>","<ball></ball>","<pyramid></pyramid>","<little-cube></little-cube>"]},{levelNumber:10,levelTitle:"Сhoose pyramids and little cube",items:["pyramid","little-ball","pyramid","little-cube","ball"],classes:["move",null,"move","move",null],answer:["pyramid, little-cube","little-cube, pyramid"],markup:["<pyramid />","<little-ball />","<pyramid />","<little-cube />","<ball />"],hints:["<pyramid></pyramid>","<little-ball></little-ball>","<pyramid></pyramid>","<little-cube></little-cube>","<ball></ball>"]}];function n(){var t=e(".game-level_active");return Number(t.id)}var a,o=function(){function t(){}return t.prototype.addHover=function(t){var l=e(".code-container__html-markup").querySelector('[data-item="'.concat(t.dataset.item,'"]'));l&&l.classList.add("active")},t.prototype.removeHover=function(){e(".code-container__string-text_html.active").classList.remove("active")},t}(),r=(a=function(e,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var l in t)Object.prototype.hasOwnProperty.call(t,l)&&(e[l]=t[l])},a(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function l(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(l.prototype=t.prototype,new l)}),i=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.clue=document.createElement("div"),t}return r(t,e),t.prototype.createClue=function(t){this.clue.classList.add("clue-container");var l=document.createElement("p");l.classList.add("clue-text"),l.innerText="".concat(t.dataset.markup),this.clue.append(l),t.append(this.clue),t.classList.add("active"),e.prototype.addHover.call(this,t)},t.prototype.deleteClue=function(){var t;this.clue.innerHTML="",null===(t=this.clue.parentElement)||void 0===t||t.classList.remove("active"),this.clue.remove(),e.prototype.removeHover.call(this)},t}(o),c=function(){var e=function(t,l){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var l in t)Object.prototype.hasOwnProperty.call(t,l)&&(e[l]=t[l])},e(t,l)};return function(t,l){if("function"!=typeof l&&null!==l)throw new TypeError("Class extends value "+String(l)+" is not a constructor or null");function n(){this.constructor=t}e(t,l),t.prototype=null===l?Object.create(l):(n.prototype=l.prototype,new n)}}(),s=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return c(n,t),n.prototype.markupBuild=function(t){var n=this,a=e(".code-container__html-markup");a.innerText="";var o=document.createElement("p");o.classList.add("code-container__string-text_html-header"),o.innerText='<div class="table">',a.append(o),l[t-1].markup.forEach((function(e,t){var l=document.createElement("p");l.classList.add("code-container__string-text_html"),l.innerText=e,l.dataset.item="".concat(t+1),a.append(l),n.addListnerOnTag(l)}));var r=document.createElement("p");r.classList.add("code-container__string-text_html-header"),r.innerText="</div>",a.append(r)},n.prototype.addListnerOnTag=function(l){var n=this;l.addEventListener("mouseover",(function(){var a=e(".table").querySelector('[data-item="'.concat(l.dataset.item,'"]'));a instanceof HTMLElement&&t.prototype.createClue.call(n,a)})),l.addEventListener("mouseout",(function(){t.prototype.deleteClue.call(n)}))},n}(i);function u(){var t=e(".code-container__input");return t.value="",t}var p,d=function(){var e=function(t,l){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var l in t)Object.prototype.hasOwnProperty.call(t,l)&&(e[l]=t[l])},e(t,l)};return function(t,l){if("function"!=typeof l&&null!==l)throw new TypeError("Class extends value "+String(l)+" is not a constructor or null");function n(){this.constructor=t}e(t,l),t.prototype=null===l?Object.create(l):(n.prototype=l.prototype,new n)}}(),v=function(t){function a(){var l=null!==t&&t.apply(this,arguments)||this;return l.markup=new s,l.playingField=e(".table"),l}return d(a,t),a.prototype.buildLevel=function(a){var o=this;this.playingField.innerHTML="",u();var r=a||n(),i=e(".level-title");this.markup.markupBuild(r),i.innerText="".concat(l[r-1].levelTitle);var c=l[r-1];c.items.forEach((function(e,l){var n=document.createElement(e),a=c.classes[l]?c.classes[l]:null;a&&n.classList.add("".concat(a)),n.dataset.markup=c.hints[l],n.dataset.item="".concat(l+1),o.playingField.append(n),n.addEventListener("mouseover",(function(){t.prototype.createClue.call(o,n)})),n.addEventListener("mouseout",(function(){t.prototype.deleteClue.call(o)}))}))},a.prototype.goUpElements=function(){this.playingField.querySelectorAll(".move").forEach((function(e){e.classList.add("go-up")}))},a}(i),m=function(){function e(){this.resetBtn=document.createElement("div")}return e.prototype.createResetBtn=function(){this.resetBtn.classList.add("reset-btn");var e=document.createElement("p");e.classList.add("reset-btn__title"),e.innerText="Reset Progress",this.resetBtn.append(e)},e}(),b=function(){var e=function(t,l){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var l in t)Object.prototype.hasOwnProperty.call(t,l)&&(e[l]=t[l])},e(t,l)};return function(t,l){if("function"!=typeof l&&null!==l)throw new TypeError("Class extends value "+String(l)+" is not a constructor or null");function n(){this.constructor=t}e(t,l),t.prototype=null===l?Object.create(l):(n.prototype=l.prototype,new n)}}(),f=function(t){function n(){var l=null!==t&&t.apply(this,arguments)||this;return l.sidebar=e(".sidebar"),l}return b(n,t),n.prototype.generateTitle=function(){var e=document.createElement("h2");e.classList.add("sidebar__title-text"),e.textContent="Level 1 of ".concat(l.length),this.sidebar.append(e),this.generateToDoName()},n.prototype.generateToDoName=function(){var e=document.createElement("p");e.classList.add("sidebar__to-do-name"),e.textContent="Choose a level:",this.sidebar.append(e)},n.prototype.generateLevelsList=function(e){var n=this;void 0===e&&(e=1),l.forEach((function(l){var a=document.createElement("div");a.classList.add("game-level"),a.id="".concat(l.levelNumber),l.levelNumber===e&&a.classList.add("game-level_active"),n.addClickHandlerOnListItem(a);var o=document.createElement("div");o.classList.add("game-level__state"),a.append(o);var r=document.createElement("p");r.classList.add("game-level__text","game-level__text_number"),r.textContent="".concat(l.levelNumber),a.append(r);var i=document.createElement("p");i.classList.add("game-level__text","game-level__text_title");var c=l.levelTitle.slice(7).split(""),s=c[0].toUpperCase();c[0]=s;var u=c.join("");i.textContent="".concat(u),a.append(i),n.sidebar.append(a),t.prototype.buildLevel.call(n,e)})),this.createResetBtn()},n.prototype.addClickHandlerOnListItem=function(l){var n=this;l.addEventListener("click",(function(){l.classList.contains("game-level_active")||(e(".game-level_active").classList.remove("game-level_active"),l.classList.add("game-level_active"),t.prototype.buildLevel.call(n,null))}))},n.prototype.createResetBtn=function(){var e=new m;e.createResetBtn(),this.sidebar.append(e.resetBtn),this.addClickHandlerOnResetBtn(e.resetBtn)},n.prototype.addClickHandlerOnResetBtn=function(t){var l=this;t.addEventListener("click",(function(){l.sidebar.querySelectorAll(".game-level").forEach((function(e){e.remove()})),t.remove();var n=e(".victory");n&&n.remove(),l.generateLevelsList()}))},n}(v);!function(e){e.enter="Enter",e.numpadEnter="NumpadEnter"}(p||(p={}));var y=function(){var e=function(t,l){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var l in t)Object.prototype.hasOwnProperty.call(t,l)&&(e[l]=t[l])},e(t,l)};return function(t,l){if("function"!=typeof l&&null!==l)throw new TypeError("Class extends value "+String(l)+" is not a constructor or null");function n(){this.constructor=t}e(t,l),t.prototype=null===l?Object.create(l):(n.prototype=l.prototype,new n)}}(),h=function(t){function a(){var l=null!==t&&t.apply(this,arguments)||this;return l.submitBtn=e(".code-container__button"),l.input=e(".code-container__input"),l}return y(a,t),a.prototype.submitBtnClickHandler=function(){var e=this;this.submitBtn.addEventListener("click",(function(){e.submit()})),document.addEventListener("keyup",(function(t){t.code!==p.enter&&t.code!==p.numpadEnter||e.submit()}))},a.prototype.submit=function(){var a=this,o=e(".game-level_active"),r=n();l[r-1].answer.includes(this.input.value)?(t.prototype.goUpElements.call(this),e(".move").addEventListener("animationend",(function(){var t=e(".game-level_active");e(".game-level__state",t).classList.add("game-level__state_done"),a.input.value="",a.input.classList.add("code-container__input_strobe"),a.checkAllTasksDone(o,r)}))):this.input.value.length&&this.wrongAnswer()},a.prototype.checkAllTasksDone=function(e,t){document.querySelectorAll(".game-level__state_done").length===l.length?this.victory():(e.classList.remove("game-level_active"),this.changeLevel(t))},a.prototype.changeLevel=function(n){if(n===l.length)this.changeLevel(0);else{var a=document.getElementById("".concat(n+1));a instanceof HTMLElement&&(e(".game-level__state",a).classList.contains("game-level__state_done")?this.changeLevel(n+1):(a.classList.add("game-level_active"),t.prototype.buildLevel.call(this,null)))}},a.prototype.victory=function(){var t=document.createElement("div");t.classList.add("victory");var l=document.createElement("p");l.classList.add("victory-text"),l.innerText="Victory!",t.append(l),e(".app-container").append(t)},a.prototype.removeMoveClass=function(){this instanceof HTMLElement&&(this.classList.remove("move"),this.removeEventListener("animationend",this.removeMoveClass))},a.prototype.wrongAnswer=function(){var t=e(".code-container");t.classList.add("move"),t.addEventListener("animationend",this.removeMoveClass)},a}(v),_=function(){var e=function(t,l){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var l in t)Object.prototype.hasOwnProperty.call(t,l)&&(e[l]=t[l])},e(t,l)};return function(t,l){if("function"!=typeof l&&null!==l)throw new TypeError("Class extends value "+String(l)+" is not a constructor or null");function n(){this.constructor=t}e(t,l),t.prototype=null===l?Object.create(l):(n.prototype=l.prototype,new n)}}(),g=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.prefix="EvgenKlo_",t}return _(t,e),t.prototype.setState=function(){var e=n();localStorage.setItem("".concat(this.prefix,"gameLevel"),String(e)),this.saveProgress()},t.prototype.getState=function(){var t=Number(localStorage.getItem("".concat(this.prefix,"gameLevel")));t?e.prototype.generateLevelsList.call(this,t):e.prototype.generateLevelsList.call(this),this.getProgress()},t.prototype.saveProgress=function(){var e=document.querySelectorAll(".game-level__state"),t=[];e.forEach((function(e){e.classList.contains("game-level__state_help")?t.push(null):e.classList.contains("game-level__state_done")?t.push(!0):t.push(!1)})),localStorage.setItem("".concat(this.prefix,"doneLevel"),JSON.stringify(t))},t.prototype.getProgress=function(){var e=localStorage.getItem("".concat(this.prefix,"doneLevel"));if(e){var t=JSON.parse(e);document.querySelectorAll(".game-level__state").forEach((function(e,l){null===t[l]?e.classList.add("game-level__state_help","game-level__state_done"):!0===t[l]&&e.classList.add("game-level__state_done")}))}},t}(f),L=function(){function t(){this.input=e(".code-container__input")}return t.prototype.listnerOnInput=function(){var e=this;this.input.addEventListener("input",(function(){e.inputNoStrobe()}))},t.prototype.inputNoStrobe=function(){var e=this;this.input.classList.remove("code-container__input_strobe"),this.input.addEventListener("input",(function(){""===e.input.value&&e.inputStrobe()}))},t.prototype.inputStrobe=function(){this.input.classList.add("code-container__input_strobe")},t}(),w=function(){var e=function(t,l){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var l in t)Object.prototype.hasOwnProperty.call(t,l)&&(e[l]=t[l])},e(t,l)};return function(t,l){if("function"!=typeof l&&null!==l)throw new TypeError("Class extends value "+String(l)+" is not a constructor or null");function n(){this.constructor=t}e(t,l),t.prototype=null===l?Object.create(l):(n.prototype=l.prototype,new n)}}(),E=function(t){function a(){var a=null!==t&&t.apply(this,arguments)||this;return a.pauseTime=500,a.helpButton=e(".help-btn"),a.printSelectorInInput=function(){a.removeClickHendlerOnHelpButton();var e=n();a.selectLevelWithHelp();var o=u(),r=l[e-1].answer[0].split("");o.value+=r[0],t.prototype.inputNoStrobe.call(a),r.shift(),a.printSymbol(r,o)},a}return w(a,t),a.prototype.addClickHendlerOnHelpButton=function(){this.helpButton.addEventListener("click",this.printSelectorInInput)},a.prototype.removeClickHendlerOnHelpButton=function(){this.helpButton.removeEventListener("click",this.printSelectorInInput)},a.prototype.printSymbol=function(e,t){var l=this;new Promise((function(t){setTimeout((function(){t(e[0])}),l.pauseTime)})).then((function(n){t.value+=n,e.shift(),e.length>0?l.printSymbol(e,t):l.addClickHendlerOnHelpButton()}))},a.prototype.selectLevelWithHelp=function(){var t=e(".game-level_active");e(".game-level__state",t).classList.add("game-level__state_help","game-level__state_done")},a}(L);(new(function(){function e(){this.appState=new g}return e.prototype.start=function(){var e=this;window.addEventListener("beforeunload",(function(){e.appState.setState()})),window.addEventListener("load",(function(){(new f).generateTitle(),(new h).submitBtnClickHandler(),e.appState.getState(),(new t).openCloseLevelMenu(),(new E).addClickHendlerOnHelpButton(),(new L).listnerOnInput()}))},e}())).start()})();